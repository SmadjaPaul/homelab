# ArgoCD Helm Values
# helm install argocd argo/argo-cd -n argocd -f values.yaml

global:
  domain: argocd.smadja.dev

configs:
  params:
    # Run insecure (TLS terminated at Cloudflare)
    server.insecure: true
  
  cm:
    # Enable status badges
    statusbadge.enabled: true
    
    # Application resync period
    timeout.reconciliation: 180s
    
    # Resource customizations for Talos
    resource.customizations: |
      argoproj.io/Application:
        health.lua: |
          hs = {}
          hs.status = "Progressing"
          hs.message = ""
          if obj.status ~= nil then
            if obj.status.health ~= nil then
              hs.status = obj.status.health.status
              if obj.status.health.message ~= nil then
                hs.message = obj.status.health.message
              end
            end
          end
          return hs

  rbac:
    policy.default: role:readonly
    policy.csv: |
      g, smadjapaul02@gmail.com, role:admin

  secret:
    # Generate with: argocd admin initial-password
    argocdServerAdminPassword: ""

server:
  replicas: 1
  
  ingress:
    enabled: false  # Using Cloudflare Tunnel instead
  
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 256Mi

controller:
  replicas: 1
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 1000m
      memory: 512Mi

repoServer:
  replicas: 1
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 256Mi

applicationSet:
  replicas: 1
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

notifications:
  enabled: true
  resources:
    requests:
      cpu: 10m
      memory: 32Mi
    limits:
      cpu: 100m
      memory: 64Mi
